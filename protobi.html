<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script src="proper/xlsx.full.js"></script>
<script src="proper/FileSaver.js"></script>
<script src="source/jquery-3.3.1.js"></script>
<body>

</body>

<script>
    var borderAll = {  //单元格外侧框线
        top: {
            style: 'thin'
        },
        bottom: {
            style: 'thin'
        },
        left: {
            style: 'thin'
        },
        right: {
            style: 'thin'
        }
    };

    var workbook = {
        SheetNames: ['Sheet1'],
        Sheets: {
            Sheet1: {
                '!ref': 'A1:W100',
                '!cols':[{wpx:20},{wpx:40},
                    {wpx:100},{wpx:100},{wpx:100},//金额标签长度
                    {wpx:100},{wpx:70},{wpx:70},
                    {wpx:100},{wpx:70},{wpx:70},
                    {wpx:100},{wpx:100},{wpx:70},
                    {wpx:100},{wpx:70},{wpx:70},
                    ],
                '!rows':[10,27,20,20,30,20,15,//设置高度
                    25,25,25,25,25,25,25,25,25,25],//总结高度
                '!merges': [
                    {//'序'字 合并
                        s: {c: 1, r: 1},//开始坐标
                        e: {c: 1, r: 2}//结束坐标
                    },
                    //免税店名合并
                    {
                        s:{c:2,r:1},
                        e:{c:4,r:1}
                    },
                    //客户名合并(合计下面)
                    {
                        s:{c:1,r:5},
                        e:{c:2,r:5},
                    },
                    //日期合并(合计下面)
                    {
                        s:{c:3,r:5},
                        e:{c:4,r:5}
                    },

                    //总结--开始
                    {
                        s:{c:2,r:7},
                        e:{c:3,r:7}
                    },
                    {
                        s:{c:4,r:7},
                        e:{c:5,r:7}
                    },
                    {
                        s:{c:2,r:8},
                        e:{c:3,r:8}
                    },
                    {
                        s:{c:4,r:8},
                        e:{c:5,r:8}
                    },
                    {
                        s:{c:2,r:9},
                        e:{c:3,r:9}
                    },
                    {
                        s:{c:4,r:9},
                        e:{c:5,r:9}
                    },
                    {
                        s:{c:2,r:10},
                        e:{c:3,r:10}
                    },
                    {
                        s:{c:4,r:10},
                        e:{c:5,r:10}
                    },
                    {
                        s:{c:2,r:11},
                        e:{c:3,r:11}
                    },
                    {
                        s:{c:4,r:11},
                        e:{c:5,r:11}
                    },
                    {
                        s:{c:2,r:12},
                        e:{c:3,r:12}
                    },
                    {
                        s:{c:4,r:12},
                        e:{c:5,r:12}
                    },
                    {
                        s:{c:2,r:13},
                        e:{c:3,r:13}
                    },
                    {
                        s:{c:4,r:13},
                        e:{c:5,r:13}
                    },
                    {
                        s:{c:2,r:14},
                        e:{c:3,r:14}
                    },
                    {
                        s:{c:4,r:14},
                        e:{c:5,r:14}
                    },
                    {
                        s:{c:2,r:15},
                        e:{c:3,r:15}
                    },
                    {
                        s:{c:4,r:15},
                        e:{c:5,r:15}
                    },
                    //总结---结束

                    //追加总结开始
                    {
                        s:{c:11,r:7},
                        e:{c:14,r:7}
                    },

                ],
                //'序'字---开始
                B2:{
                    v:'序',//内容
                    t:'s',//应该是变量类型, s为String
                    s:{//Style
                        alignment:cellContentPosition.textCenter,
                        border:borderStyle.boldLine,//边线
                        fill:{
                            fgColor:{rgb : "86e38d"}
                        }
                    }
                },
                B3:{
                    s:{
                        border:borderAll
                    }
                },
            }
        }
    };

    function s2ab(s) {
        var buf = new ArrayBuffer(s.length);
        var view = new Uint8Array(buf);
        for (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;
        return buf;
    }

    $(function () {
        var wopts = { bookType:'xlsx', bookSST:false, type:'binary' };

        var wbout = XLSX.write(workbook,wopts);
        console.log('wbout==>'+wbout);

        /* the saveAs call downloads a file on the local machine */
        saveAs(new Blob([s2ab(wbout)],{type:""}), "test.xlsx");
    });



</script>

</html>